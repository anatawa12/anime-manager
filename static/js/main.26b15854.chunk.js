(this["webpackJsonpanime-manager"]=this["webpackJsonpanime-manager"]||[]).push([[0],{135:function(e,t,a){},136:function(e,t,a){},143:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(45),i=a.n(c),s=(a(135),a(64)),l=a(13),o=a(5),u=a(39),j=a(54),d=a(55),h=a(83),b=a(82),f=a(67),O=a(68),m=a(52),v=a(38),p=a(192),y=a(111),x=a(187),g=a(201),w=a(110),A=a(208),k=a(210),I=a(211),M=a(212),S=a(213),D=a(214),N=a(215),C=a(216),_=a(202),W=a(205),E=a(200),F=(a(136),a(66)),z=a(1);function L(){return Object(z.jsx)(S.a,{children:Object(z.jsx)(D.a,{colSpan:7,children:Object(z.jsx)("div",{className:"TodayMarker",children:"\u4eca\u65e5"})})})}function T(e){return Object(z.jsxs)(S.a,{children:[Object(z.jsx)(D.a,{children:Object(z.jsx)(_.a,{size:"small",fullWidth:!0,value:e.animeInfo.name,onChange:function(t){return e.updateAnimeInfo({name:t.target.value})}})}),Object(z.jsxs)(D.a,{children:[e.number,"\u8a71"]}),Object(z.jsx)(D.a,{children:Object(y.a)(e.available,"yyyy/MM/dd")}),Object(z.jsx)(D.a,{children:Object(z.jsx)(A.a,{control:Object(z.jsx)(W.a,{checked:e.watched,onChange:function(t){return e.markWatched(t.target.checked)}}),label:"\u8996\u8074\u6e08\u307f"})}),Object(z.jsx)(D.a,{children:Object(z.jsx)(E.a,{onChange:function(t){return e.updateAnimeInfo({start:t})},mask:"____/__/__",value:e.animeInfo.start,renderInput:function(e){return Object(z.jsx)(_.a,Object(u.a)(Object(u.a)({},e),{},{style:{width:"150px"},size:"small"}))}})}),Object(z.jsx)(D.a,{children:Object(z.jsx)(_.a,{size:"small",style:{width:"100px"},value:e.animeInfo.first,onChange:function(t){return e.updateAnimeInfo({first:Number(t.target.value)})},inputProps:{inputMode:"numeric",pattern:"[0-9]*"}})}),Object(z.jsx)(D.a,{children:Object(z.jsx)(_.a,{size:"small",style:{width:"100px"},value:e.animeInfo.intervalDays,onChange:function(t){return e.updateAnimeInfo({intervalDays:Number(t.target.value)})},inputProps:{inputMode:"numeric",pattern:"[0-9]*"}})})]})}var J=function(e){Object(h.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).state={showAll:!1},n}return Object(d.a)(a,[{key:"updateAnimeInfo",value:function(e,t){this.props.setInfo((function(a){return null==a[e]?a:Object(u.a)(Object(u.a)({},a),{},Object(o.a)({},e,Object.assign(a[e],t)))}))}},{key:"markWatched",value:function(e,t,a){this.props.setInfo((function(n){if(null==n[e])return n;var r=n[e],c=r.watched.has(t);return a===c?n:(a?r.watched.add(t):r.watched.delete(t),Object(u.a)(Object(u.a)({},n),{},Object(o.a)({},e,r)))}))}},{key:"computeAnimeNumbers",value:function(){var e=Object(f.a)(new Date),t=this.props.info,n=Object.create(null);function r(e,t){return Object(O.a)(t.start,e*t.intervalDays)}for(var c=0,i=Object.entries(t);c<i.length;c++){var o,u=Object(l.a)(i[c],2),j=u[0],d=u[1],h=new Map,b=Object(O.a)(e,d.intervalDays),v=Object(s.a)(d.watched);try{for(v.s();!(o=v.n()).done;){var p=o.value;h.set(p,{id:j,index:p,info:d,type:"anime",available:r(p,d),watched:!0})}}catch(w){v.e(w)}finally{v.f()}for(var y=Array.from(h.values()),x=0;;x++){var g=r(x,d);if(Object(m.a)(g,b)>0)break;h.has(x)||y.push({id:j,index:x,info:d,available:g,type:"anime",watched:!1})}a.sortAnime(y),n[j]=y}return n}},{key:"computeNotWatchedAnime",value:function(){for(var e=this.computeAnimeNumbers(),t=[],n=0,r=Object.values(e);n<r.length;n++){var c,i,l,o=r[n],u=Object(s.a)(o);try{for(u.s();!(l=u.n()).done;){var j=l.value;j.watched||t.push(j)}}catch(d){u.e(d)}finally{u.f()}(null===(c=o[0])||void 0===c?void 0:c.watched)&&t.push(o[0]),(null===(i=o[1])||void 0===i?void 0:i.watched)&&t.push(o[1])}return t.push(a.todayAnimeMarker()),a.sortAnime(t),t}},{key:"computeAllAnime",value:function(){var e=this.computeAnimeNumbers(),t=Object.values(e).flatMap((function(e){return e}));return t.push(a.todayAnimeMarker()),a.sortAnime(t),t}},{key:"addNewAnime",value:function(){this.props.setInfo((function(e){var t;do{t=Object(F.b)(crypto.getRandomValues(new Uint8Array(9)).buffer)}while(null!=e[t]);return Object(u.a)(Object(u.a)({},e),{},Object(o.a)({},t,{name:"\u30a2\u30cb\u30e1".concat(Object.keys(e).length+1),start:Object(v.a)(new Date),first:1,intervalDays:7,watched:new Set}))}))}},{key:"render",value:function(){var e=this;console.log(this.props.info);var t=this.state.showAll?this.computeAllAnime():this.computeNotWatchedAnime();return Object(z.jsx)(z.Fragment,{children:Object(z.jsxs)(x.b,{dateAdapter:g.a,locale:w.a,children:[Object(z.jsx)(A.a,{control:Object(z.jsx)(k.a,{checked:this.state.showAll,onChange:function(t,a){return e.setState({showAll:a})}}),label:"\u3059\u3079\u3066\u8868\u793a"}),Object(z.jsxs)(I.a,{size:"small",children:[Object(z.jsx)(M.a,{children:Object(z.jsxs)(S.a,{children:[Object(z.jsx)(D.a,{children:"\u30a2\u30cb\u30e1"}),Object(z.jsx)(D.a,{children:"\u8a71\u6570"}),Object(z.jsx)(D.a,{children:"\u653e\u9001\u65e5"}),Object(z.jsx)(D.a,{children:"\u8996\u8074\u6e08\u307f"}),Object(z.jsx)(D.a,{children:"\u521d\u56de\u653e\u9001\u65e5"}),Object(z.jsx)(D.a,{children:"\u521d\u56de"}),Object(z.jsx)(D.a,{children:"\u9694\u65e5"})]})}),Object(z.jsx)(N.a,{children:t.map((function(t){return"today-marker"===t.type?Object(z.jsx)(L,{},"today-marker"):Object(z.jsx)(T,{number:t.index+t.info.first,available:t.available,animeInfo:t.info,updateAnimeInfo:e.updateAnimeInfo.bind(e,t.id),watched:t.watched,markWatched:e.markWatched.bind(e,t.id,t.index)},"".concat(t.id,"-").concat(t.index))}))})]}),Object(z.jsx)(C.a,{onClick:this.addNewAnime.bind(this),children:"+"})]})})}}],[{key:"sortAnime",value:function(e){e.sort((function(e,t){return Object(p.a)(e.available,t.available)}))}},{key:"todayAnimeMarker",value:function(){return{type:"today-marker",available:Object(f.a)(new Date)}}}]),a}(r.a.Component),P=a(199),U=a(109),H="all-anime-info",B=Object(v.a)(new Date);var G=function(e){return"number"==typeof e&&Number.isSafeInteger(e)},R=function(e){return"string"==typeof e};var V=function(){var e=r.a.useState((function(){var e;return function(e){try{for(var t=JSON.parse(e),a={},n=0,r=Object.entries(t);n<r.length;n++){var c=Object(l.a)(r[n],2),i=c[0],s=c[1];R(s.name)&&R(s.start)&&G(s.first)&&G(s.intervalDays)&&R(s.watched)&&(a[i]={name:s.name,start:Object(U.a)(s.start,"yyyyMMdd",B),first:s.first,intervalDays:s.intervalDays,watched:o(s.watched)})}return a}catch(u){return console.error(u),{}}function o(e){for(var t=new Set,a=4*Math.ceil(e.length/4),n=new Uint8Array(Object(F.a)(e.padStart(a,"A"))),r=8*n.length,c=0;c<r;c++)0!==(n[Math.floor(c/8)]&128>>c%8)&&t.add(c);return t}}(null!==(e=localStorage.getItem(H))&&void 0!==e?e:"{}")})),t=Object(l.a)(e,2),a=t[0],n=t[1];return(0!==Object.keys(a).length||localStorage.getItem(H))&&(localStorage.setItem(H,function(e){for(var t={},a=0,n=Object.entries(e);a<n.length;a++){var r=Object(l.a)(n[a],2),c=r[0],i=r[1];t[c]={name:i.name,start:Object(y.a)(i.start,"yyyyMMdd"),first:i.first,intervalDays:i.intervalDays,watched:o(i.watched)}}return JSON.stringify(t);function o(e){var t,a=new Uint8Array(2),n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,c=Math.floor(r/8);(a=u(a,c))[c]|=128>>r%8}}catch(i){n.e(i)}finally{n.f()}return Object(F.b)(a.buffer).replace(/^A*/,"").replace(/=*$/,"")}function u(e,t){for(var a=e.length;t>=a;)t*=2;if(a===e.length)return e;var n=new Uint8Array(a);return n.set(e),n}}(a)),console.log("saved")),Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(P.a,{}),Object(z.jsx)("p",{children:"\u30a2\u30cb\u30e1\u3084\u30c9\u30e9\u30de\u3092\u4f55\u8a71\u307e\u3067\u898b\u305f\u304b\u3092\u7ba1\u7406\u3059\u308b\u30c4\u30fc\u30eb"}),Object(z.jsx)("p",{children:"\u30cb\u30b3\u30cb\u30b3\u306e\u3088\u3046\u306a\u4e00\u9031\u9593\u7121\u6599\u516c\u958b\u306a\u3082\u306e\u5411\u3051\u306b\u4f5c\u308a\u307e\u3057\u305f\u3002"}),Object(z.jsx)("p",{children:"\u30d6\u30e9\u30a6\u30b6\u306b\u5165\u529b\u3057\u305f\u60c5\u5831\u304c\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"}),Object(z.jsxs)("p",{children:[Object(z.jsx)("small",{children:"\xa9 anatawa12 and other contributors 2021"}),"This software is published under MIT License. See ",Object(z.jsx)("a",{href:"https://github.com/anatawa12/anime-manager/tree/HEAD/LICENSE",children:"LICENSE on GitHub"}),". You can see project page on ",Object(z.jsx)("a",{href:"https://github.com/anatawa12/anime-manager",children:"GitHub"}),". See ",Object(z.jsx)("a",{href:"./license-disclaimer.txt",children:"license-disclaimer"})," for licenses of third-pretty software."]}),Object(z.jsx)(J,{info:a,setInfo:n})]})},Y=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,218)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))};i.a.render(Object(z.jsx)(r.a.StrictMode,{children:Object(z.jsx)(V,{})}),document.getElementById("root")),Y()}},[[143,1,2]]]);
//# sourceMappingURL=main.26b15854.chunk.js.map