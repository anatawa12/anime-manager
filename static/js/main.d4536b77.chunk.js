(this["webpackJsonpanime-manager"]=this["webpackJsonpanime-manager"]||[]).push([[0],{147:function(e,t,n){},148:function(e,t,n){},157:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(47),i=n.n(c),s=(n(147),n(70)),l=n(13),o=n(5),u=n(40),j=n(59),d=n(60),b=n(91),h=n(90),f=n(73),O=n(74),m=n(55),v=n(39),p=n(214),x=n(118),y=n(211),g=n(223),w=n(117),A=n(115),k=n.n(A),I=n(235),M=n(226),S=n(216),C=n(239),N=n(237),D=n(236),W=n(238),E=n(228),_=n(229),F=n(230),T=n(234),z=n(233),L=n(231),J=n(232),P=n(224),U=n(222),B=(n(148),n(72)),H=n(1);function G(){return Object(H.jsx)(J.a,{children:Object(H.jsx)(z.a,{colSpan:7,children:Object(H.jsx)("div",{className:"TodayMarker",children:"\u4eca\u65e5"})})})}function $(e){var t=r.a.useState(!1),n=Object(l.a)(t,2),a=n[0],c=n[1],i=r.a.useState(!1),s=Object(l.a)(i,2),o=s[0],j=s[1];return Object(H.jsxs)(J.a,{children:[Object(H.jsx)(z.a,{className:"EditButton",children:Object(H.jsx)(I.a,{className:"MinWidth",onClick:function(){return c(!0)},children:Object(H.jsx)(k.a,{})})}),Object(H.jsx)(z.a,{children:e.animeInfo.name}),Object(H.jsxs)(z.a,{children:[e.number,"\u8a71"]}),Object(H.jsx)(z.a,{children:Object(x.a)(e.available,"yyyy/MM/dd")}),Object(H.jsx)(z.a,{children:Object(H.jsx)(E.a,{control:Object(H.jsx)(M.a,{checked:e.watched,onChange:function(t){return e.markWatched(t.target.checked)}}),label:"\u8996\u8074\u6e08\u307f"})}),Object(H.jsxs)(S.a,{open:a,children:[Object(H.jsxs)(D.a,{children:["Edit ",e.animeInfo.name]}),Object(H.jsx)(N.a,{children:Object(H.jsxs)(W.a,{sx:{"& > :not(style)":{m:1,width:"25ch"}},children:[Object(H.jsx)(P.a,{size:"small",fullWidth:!0,label:"\u540d\u524d",value:e.animeInfo.name,onChange:function(t){return e.updateAnimeInfo({name:t.target.value})}}),Object(H.jsx)(U.a,{onChange:function(t){return e.updateAnimeInfo({start:t})},mask:"____/__/__",value:e.animeInfo.start,renderInput:function(e){return Object(H.jsx)(P.a,Object(u.a)(Object(u.a)({},e),{},{size:"small",fullWidth:!0,label:"\u521d\u56de\u653e\u9001\u65e5"}))}}),Object(H.jsx)(P.a,{size:"small",fullWidth:!0,label:"\u521d\u56de",value:e.animeInfo.first,onChange:function(t){return e.updateAnimeInfo({first:Number(t.target.value)})},inputProps:{inputMode:"numeric",pattern:"[0-9]*"}}),Object(H.jsx)(P.a,{size:"small",fullWidth:!0,label:"\u9694\u65e5",value:e.animeInfo.intervalDays,onChange:function(t){return e.updateAnimeInfo({intervalDays:Number(t.target.value)})},inputProps:{inputMode:"numeric",pattern:"[0-9]*"}})]})}),Object(H.jsxs)(C.a,{children:[Object(H.jsx)(I.a,{onClick:function(){return j(!0)},children:"\u524a\u9664"}),Object(H.jsx)(I.a,{onClick:function(){return c(!1)},children:"\u9589\u3058\u308b"}),Object(H.jsxs)(S.a,{open:o,children:[Object(H.jsxs)(D.a,{children:[e.animeInfo.name,"\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"]}),Object(H.jsxs)(C.a,{children:[Object(H.jsx)(I.a,{onClick:function(){return e.delete()},children:"\u524a\u9664"}),Object(H.jsx)(I.a,{onClick:function(){return c(!1)},children:"\u30ad\u30e3\u30f3\u30bb\u30eb"})]})]})]})]})]})}var R=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(j.a)(this,n),(a=t.call(this,e)).state={showAll:!1},a}return Object(d.a)(n,[{key:"deleteAnime",value:function(e){this.props.setInfo((function(t){var n=Object.assign({},t);return delete n[e],n}))}},{key:"updateAnimeInfo",value:function(e,t){this.props.setInfo((function(n){return null==n[e]?n:Object(u.a)(Object(u.a)({},n),{},Object(o.a)({},e,Object.assign(n[e],t)))}))}},{key:"markWatched",value:function(e,t,n){this.props.setInfo((function(a){if(null==a[e])return a;var r=a[e],c=r.watched.has(t);return n===c?a:(n?r.watched.add(t):r.watched.delete(t),Object(u.a)(Object(u.a)({},a),{},Object(o.a)({},e,r)))}))}},{key:"computeAnimeNumbers",value:function(){var e=Object(f.a)(new Date),t=this.props.info,a=Object.create(null);function r(e,t){return Object(O.a)(t.start,e*t.intervalDays)}for(var c=0,i=Object.entries(t);c<i.length;c++){var o,u=Object(l.a)(i[c],2),j=u[0],d=u[1],b=new Map,h=Object(O.a)(e,d.intervalDays),v=Object(s.a)(d.watched);try{for(v.s();!(o=v.n()).done;){var p=o.value;b.set(p,{id:j,index:p,info:d,type:"anime",available:r(p,d),watched:!0})}}catch(w){v.e(w)}finally{v.f()}for(var x=Array.from(b.values()),y=0;;y++){var g=r(y,d);if(0!==y&&Object(m.a)(g,h)>0)break;b.has(y)||x.push({id:j,index:y,info:d,available:g,type:"anime",watched:!1})}n.sortAnime(x),a[j]=x}return a}},{key:"computeNotWatchedAnime",value:function(){for(var e=this.computeAnimeNumbers(),t=[],a=0,r=Object.values(e);a<r.length;a++){var c,i,l,o=r[a],u=Object(s.a)(o);try{for(u.s();!(l=u.n()).done;){var j=l.value;j.watched||t.push(j)}}catch(d){u.e(d)}finally{u.f()}(null===(c=o[0])||void 0===c?void 0:c.watched)&&t.push(o[0]),(null===(i=o[1])||void 0===i?void 0:i.watched)&&t.push(o[1])}return t.push(n.todayAnimeMarker()),n.sortAnime(t),t}},{key:"computeAllAnime",value:function(){var e=this.computeAnimeNumbers(),t=Object.values(e).flatMap((function(e){return e}));return t.push(n.todayAnimeMarker()),n.sortAnime(t),t}},{key:"addNewAnime",value:function(){this.props.setInfo((function(e){var t;do{t=Object(B.b)(crypto.getRandomValues(new Uint8Array(9)).buffer)}while(null!=e[t]);return Object(u.a)(Object(u.a)({},e),{},Object(o.a)({},t,{name:"\u30a2\u30cb\u30e1".concat(Object.keys(e).length+1),start:Object(v.a)(new Date),first:1,intervalDays:7,watched:new Set}))}))}},{key:"render",value:function(){var e=this;console.log(this.props.info);var t=this.state.showAll?this.computeAllAnime():this.computeNotWatchedAnime();return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(y.b,{dateAdapter:g.a,locale:w.a,children:Object(H.jsxs)("div",{className:"AnimeTable",children:[Object(H.jsx)(E.a,{control:Object(H.jsx)(_.a,{checked:this.state.showAll,onChange:function(t,n){return e.setState({showAll:n})}}),label:"\u3059\u3079\u3066\u8868\u793a"}),Object(H.jsxs)(F.a,{size:"small",children:[Object(H.jsx)(L.a,{children:Object(H.jsxs)(J.a,{children:[Object(H.jsx)(z.a,{}),Object(H.jsx)(z.a,{children:"\u30a2\u30cb\u30e1"}),Object(H.jsx)(z.a,{children:"\u8a71\u6570"}),Object(H.jsx)(z.a,{children:"\u653e\u9001\u65e5"}),Object(H.jsx)(z.a,{children:"\u8996\u8074\u6e08\u307f"})]})}),Object(H.jsx)(T.a,{children:t.map((function(t){return"today-marker"===t.type?Object(H.jsx)(G,{},"today-marker"):Object(H.jsx)($,{number:t.index+t.info.first,available:t.available,animeInfo:t.info,updateAnimeInfo:e.updateAnimeInfo.bind(e,t.id),watched:t.watched,markWatched:e.markWatched.bind(e,t.id,t.index),delete:e.deleteAnime.bind(e,t.id)},"".concat(t.id,"-").concat(t.index))}))})]}),Object(H.jsx)(I.a,{onClick:this.addNewAnime.bind(this),children:"+"})]})})})}}],[{key:"sortAnime",value:function(e){e.sort((function(e,t){return Object(p.a)(e.available,t.available)}))}},{key:"todayAnimeMarker",value:function(){return{type:"today-marker",available:Object(f.a)(new Date)}}}]),n}(r.a.Component),V=n(221),Y=n(116),q="all-anime-info",K=Object(v.a)(new Date);var Q=function(e){return"number"==typeof e&&Number.isSafeInteger(e)},X=function(e){return"string"==typeof e};var Z=function(){var e=r.a.useState((function(){var e;return function(e){try{for(var t=JSON.parse(e),n={},a=0,r=Object.entries(t);a<r.length;a++){var c=Object(l.a)(r[a],2),i=c[0],s=c[1];X(s.name)&&X(s.start)&&Q(s.first)&&Q(s.intervalDays)&&X(s.watched)&&(n[i]={name:s.name,start:Object(Y.a)(s.start,"yyyyMMdd",K),first:s.first,intervalDays:s.intervalDays,watched:o(s.watched)})}return n}catch(u){return console.error(u),{}}function o(e){for(var t=new Set,n=4*Math.ceil(e.length/4),a=new Uint8Array(Object(B.a)(e.padEnd(n,"A"))),r=8*a.length,c=0;c<r;c++)0!==(a[Math.floor(c/8)]&128>>c%8)&&t.add(c);return t}}(null!==(e=localStorage.getItem(q))&&void 0!==e?e:"{}")})),t=Object(l.a)(e,2),n=t[0],a=t[1];return(0!==Object.keys(n).length||localStorage.getItem(q))&&(localStorage.setItem(q,function(e){for(var t={},n=0,a=Object.entries(e);n<a.length;n++){var r=Object(l.a)(a[n],2),c=r[0],i=r[1];t[c]={name:i.name,start:Object(x.a)(i.start,"yyyyMMdd"),first:i.first,intervalDays:i.intervalDays,watched:o(i.watched)}}return JSON.stringify(t);function o(e){var t,n=new Uint8Array(2),a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,c=Math.floor(r/8);(n=u(n,c))[c]|=128>>r%8}}catch(i){a.e(i)}finally{a.f()}return Object(B.b)(n.buffer).replace(/=*$/,"").replace(/A*$/,"")}function u(e,t){for(var n=e.length;t>=n;)t*=2;if(n===e.length)return e;var a=new Uint8Array(n);return a.set(e),a}}(n)),console.log("saved")),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(V.a,{}),Object(H.jsx)("p",{children:"\u30a2\u30cb\u30e1\u3084\u30c9\u30e9\u30de\u3092\u4f55\u8a71\u307e\u3067\u898b\u305f\u304b\u3092\u7ba1\u7406\u3059\u308b\u30c4\u30fc\u30eb"}),Object(H.jsx)("p",{children:"\u30cb\u30b3\u30cb\u30b3\u306e\u3088\u3046\u306a\u4e00\u9031\u9593\u7121\u6599\u516c\u958b\u306a\u3082\u306e\u5411\u3051\u306b\u4f5c\u308a\u307e\u3057\u305f\u3002"}),Object(H.jsx)("p",{children:"\u30d6\u30e9\u30a6\u30b6\u306b\u5165\u529b\u3057\u305f\u60c5\u5831\u304c\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"}),Object(H.jsx)("p",{children:Object(H.jsx)("small",{children:"\xa9 anatawa12 and other contributors 2021"})}),Object(H.jsx)("p",{children:Object(H.jsxs)("small",{children:["This software is published under MIT License. See ",Object(H.jsx)("a",{href:"https://github.com/anatawa12/anime-manager/tree/HEAD/LICENSE",children:"LICENSE on GitHub"}),". You can see project page on ",Object(H.jsx)("a",{href:"https://github.com/anatawa12/anime-manager",children:"GitHub"}),". See ",Object(H.jsx)("a",{href:"./license-disclaimer.txt",children:"license-disclaimer"})," for licenses of third-pretty software."]})}),Object(H.jsx)(R,{info:n,setInfo:a})]})},ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,241)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};i.a.render(Object(H.jsx)(r.a.StrictMode,{children:Object(H.jsx)(Z,{})}),document.getElementById("root")),ee()}},[[157,1,2]]]);
//# sourceMappingURL=main.d4536b77.chunk.js.map